!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t){var n;!function(e){"use strict";String.fromCharCode;var t=2*+Math.PI,n=16,r=1,a=Math.sin,i=Math.pow,o=Math.abs;e.SampleRate=0,e.Sec=0,e.SetSampleRate=function(t){e.SampleRate=0|t,e.Sec=0|t},e.SetSampleRate(function(){if(void 0!==u)return(new u).sampleRate;return 44100}()),e.Sound=function(t){var n=new h(t,e.DefaultModules),r=F(n.getSamplesLeft());return n.generate(r),m(r)},e.Sounds=function(t,n,r){var a={},i={};i._audio=a;var o=[];P(t,function(e,t){i[t]=function(){void 0!==a[t]&&(a[t].currentTime=0,a[t].play())},o.push(t)});var u=0,s=o.length;return function i(){if(0!=o.length){var l=o.shift();a[l]=e.Sound(t[l]),r&&r(l,++u,s),window.setTimeout(i,30)}else n&&n(sounds)}(),i},e.SoundsImmediate=function(t){var n={},r={};return r._audio=n,P(t,function(t,a){n[a]=e.Sound(t),r[a]=function(){void 0!==n[a]&&(n[a].currentTime=0,n[a].play())}}),r};var u=window.AudioContext||window.webkitAudioContext;void 0!==u?(e.Node=function(t,n,r,a,i){var o=t.createScriptProcessor(a,0,1),u=new h(n,r||e.DefaultModules);return o.onaudioprocess=function(e){var t=e.outputBuffer.getChannelData(0);u.generate(t),!i&&u.finished&&setTimeout(function(){o.disconnect()},30)},o},e.Live=function(t,n,r){r=r||2048;var a={},i=new u,o=i.createGain();function s(e,t){var n=i.createBufferSource();return n.buffer=e,n.start=n.start||n.noteOn,n.start(t),n.onended=function(){n.disconnect()},n}return o.connect(i.destination),a._context=i,a._volume=o,P(t,function(t,u){a[u]=function(){e.Node(i,t,n,r).connect(o)}}),a._close=function(){i.close()},a._play=function(t){e.Node(i,t,n,r).connect(o)},a._createBuffer=function(t){var n=new h(t,e.DefaultModules),r=F(n.getSamplesLeft());return n.generate(r),a._createBufferFromBlock(r)},a._createEmptyBuffer=function(){return a._createBufferFromBlock([0])},a._createBufferFromBlock=function(t){var n=i.createBuffer(1,t.length,e.SampleRate);return n.getChannelData(0).set(t),n},a._playBuffer=function(e,t){s(e,t).connect(o)},a._playBufferAndConnect=function(e,t,n){s(e,t).connect(n),n.connect(o)},a._createGain=function(){return i.createGain()},a}):e.Live=function(e,t,n){return null},e.Module={},e.G={};var s=e.stage={PhaseSpeed:0,PhaseSpeedMod:10,Generator:20,SampleMod:30,Volume:40};function l(e,t){return e.stage-t.stage}function c(e,t){for(var n=0;n<t.length;n+=1){var r=t[n],a=e[r.name]||{};P(r.params,function(e,t){void 0===a[t]&&(a[t]=e.D)}),e[r.name]=a}}function h(t,n){t=t||{},n=n||e.DefaultModules,t="function"==typeof t?t():JSON.parse(JSON.stringify(t)),this.finished=!1,this.state={SampleRate:t.SampleRate||e.SampleRate},(n=n.slice()).sort(l),this.modules=n,c(t,n);for(var r=0;r<this.modules.length;r+=1){var a=this.modules[r];this.modules[r].setup(this.state,t[a.name])}}e.InitDefaultParams=c,e.Processor=h,h.prototype={generate:function(e){for(var t=0;t<e.length;t+=1)e[t]=0;if(!this.finished){var n=this.state,r=0|e.length;for(t=0;t<this.modules.length;t+=1){var a=0|this.modules[t].process(n,e.subarray(0,r));r=Math.min(r,a)}r<e.length&&(this.finished=!0);for(t=r;t<e.length;t++)e[t]=0}},getSamplesLeft:function(){for(var e=0,t=0;t<this.state.envelopes.length;t+=1)e+=this.state.envelopes[t].N;return 0===e&&(e=3*this.state.SampleRate),e}},e.Module.Frequency={name:"Frequency",params:{Start:{L:30,H:1800,D:440},Min:{L:30,H:1800,D:30},Max:{L:30,H:1800,D:1800},Slide:{L:-1,H:1,D:0},DeltaSlide:{L:-1,H:1,D:0},RepeatSpeed:{L:0,H:3,D:0},ChangeAmount:{L:-12,H:12,D:0},ChangeSpeed:{L:0,H:1,D:0}},stage:s.PhaseSpeed,setup:function(e,n){var r=e.SampleRate;e.phaseParams=n,e.phaseSpeed=n.Start*t/r,e.phaseSpeedMax=n.Max*t/r,e.phaseSpeedMin=n.Min*t/r,e.phaseSpeedMin=Math.min(e.phaseSpeedMin,e.phaseSpeed),e.phaseSpeedMax=Math.max(e.phaseSpeedMax,e.phaseSpeed),e.phaseSlide=1+64*i(n.Slide,3)/r,e.phaseDeltaSlide=i(n.DeltaSlide,3)/(1e3*r),e.repeatTime=0,e.repeatLimit=1/0,n.RepeatSpeed>0&&(e.repeatLimit=n.RepeatSpeed*r),e.arpeggiatorTime=0,e.arpeggiatorLimit=n.ChangeSpeed*r,0==n.ChangeAmount&&(e.arpeggiatorLimit=1/0),e.arpeggiatorMod=1+n.ChangeAmount/12},process:function(e,t){for(var n=+e.phaseSpeed,r=+e.phaseSpeedMin,a=+e.phaseSpeedMax,i=+e.phaseSlide,o=+e.phaseDeltaSlide,u=e.repeatTime,s=e.repeatLimit,l=e.arpeggiatorTime,c=e.arpeggiatorLimit,h=e.arpeggiatorMod,f=0;f<t.length;f++){if(n=(n*=i+=o)<r?r:n>a?a:n,u>s)return this.setup(e,e.phaseParams),f+this.process(e,t.subarray(f))-1;u++,l>c&&(n*=h,l=0,c=1/0),l++,t[f]+=n}return e.repeatTime=u,e.arpeggiatorTime=l,e.arpeggiatorLimit=c,e.phaseSpeed=n,e.phaseSlide=i,t.length}},e.Module.Vibrato={name:"Vibrato",params:{Depth:{L:0,H:1,D:0},DepthSlide:{L:-1,H:1,D:0},Frequency:{L:.01,H:48,D:0},FrequencySlide:{L:-1,H:1,D:0}},stage:s.PhaseSpeedMod,setup:function(e,n){var r=e.SampleRate;e.vibratoPhase=0,e.vibratoDepth=n.Depth,e.vibratoPhaseSpeed=n.Frequency*t/r,e.vibratoPhaseSpeedSlide=1+3*i(n.FrequencySlide,3)/r,e.vibratoDepthSlide=n.DepthSlide/r},process:function(e,n){var r=+e.vibratoPhase,i=+e.vibratoDepth,o=+e.vibratoPhaseSpeed,u=+e.vibratoPhaseSpeedSlide,s=+e.vibratoDepthSlide;if(0==i&&s<=0)return n.length;for(var l=0;l<n.length;l++)(r+=o)>t&&(r-=t),n[l]+=n[l]*a(r)*i,o*=u,i=v(i+=s);return e.vibratoPhase=r,e.vibratoDepth=i,e.vibratoPhaseSpeed=o,n.length}},e.Module.Generator={name:"Generator",params:{Func:{C:e.G,D:"square"},A:{L:0,H:1,D:0},B:{L:0,H:1,D:0},ASlide:{L:-1,H:1,D:0},BSlide:{L:-1,H:1,D:0}},stage:s.Generator,setup:function(t,n){t.generatorPhase=0,"string"==typeof n.Func?t.generator=e.G[n.Func]:t.generator=n.Func,"object"==typeof t.generator&&(t.generator=t.generator.create()),S("function"==typeof t.generator,"generator must be a function"),t.generatorA=n.A,t.generatorASlide=n.ASlide,t.generatorB=n.B,t.generatorBSlide=n.BSlide},process:function(e,t){return e.generator(e,t)}};e.Module.Guitar={name:"Guitar",params:{A:{L:0,H:1,D:1},B:{L:0,H:1,D:1},C:{L:0,H:1,D:1}},stage:s.Generator,setup:function(e,t){e.guitarA=t.A,e.guitarB=t.B,e.guitarC=t.C,e.guitarBuffer=F(65536),e.guitarHead=0;for(var n=e.guitarBuffer,r=0;r<n.length;r++)n[r]=2*D()-1},process:function(e,n){for(var r=65536,a=r-1,i=+e.guitarA,o=+e.guitarB,u=+e.guitarC,s=i+o+u,l=e.guitarHead,c=e.guitarBuffer,h=0;h<n.length;h++){var f=t/n[h]|0,p=l-(f=f>r?r:f)+r&a;c[l]=(c[p-0+r&a]*i+c[p-1+r&a]*o+c[p-2+r&a]*u)/s,n[h]=c[l],l=l+1&a}return e.guitarHead=l,n.length}},e.Module.Filter={name:"Filter",params:{LP:{L:0,H:1,D:1},LPSlide:{L:-1,H:1,D:0},LPResonance:{L:0,H:1,D:0},HP:{L:0,H:1,D:0},HPSlide:{L:-1,H:1,D:0}},stage:s.SampleMod+0,setup:function(e,t){e.FilterEnabled=t.HP>1e-6||t.LP<1-1e-6,e.LPEnabled=t.LP<1-1e-6,e.LP=i(t.LP,3)/10,e.LPSlide=1+100*t.LPSlide/e.SampleRate,e.LPPos=0,e.LPPosSlide=0,e.LPDamping=5/(1+20*i(t.LPResonance,2))*(.01+t.LP),e.LPDamping=1-Math.min(e.LPDamping,.8),e.HP=i(t.HP,2)/10,e.HPPos=0,e.HPSlide=1+100*t.HPSlide/e.SampleRate},enabled:function(e){return e.FilterEnabled},process:function(e,t){if(!this.enabled(e))return t.length;for(var n=+e.LP,r=+e.LPPos,a=+e.LPPosSlide,i=+e.LPSlide,o=+e.LPDamping,u=+e.LPEnabled,s=+e.HP,l=+e.HPPos,c=+e.HPSlide,h=0;h<t.length;h++){(s>1e-6||s<-1e-6)&&(s=(s*=c)<1e-6?1e-6:s>.1?.1:s);var f=r;n=(n*=i)<0?n=0:n>.1?.1:n;var p=t[h];u?(a+=(p-r)*n,a*=o):(r=p,a=0),l+=(r+=a)-f,l*=1-s,t[h]=l}return e.LPPos=r,e.LPPosSlide=a,e.LP=n,e.HP=s,e.HPPos=l,t.length}};function f(){return P(e.Module,function(){return{}})}function p(e){for(var t in e)0==A(e[t]).length&&delete e[t]}e.Module.Phaser={name:"Phaser",params:{Offset:{L:-1,H:1,D:0},Sweep:{L:-1,H:1,D:0}},stage:s.SampleMod+1,setup:function(e,t){e.phaserBuffer=F(1024),e.phaserPos=0,e.phaserOffset=1020*i(t.Offset,2),e.phaserOffsetSlide=4e3*i(t.Sweep,3)/e.SampleRate},enabled:function(e){return o(e.phaserOffsetSlide)>1e-6||o(e.phaserOffset)>1e-6},process:function(e,t){if(!this.enabled(e))return t.length;for(var n=e.phaserBuffer,r=0|e.phaserPos,a=+e.phaserOffset,i=+e.phaserOffsetSlide,o=0;o<t.length;o++){(a+=i)<0&&(a=-a,i=-i),a>1023&&(a=1023,i=0),n[r]=t[o];var u=r-(0|a)+1024&1023;t[o]+=n[u],r=r+1&1023|0}return e.phaserPos=r,e.phaserOffset=a,t.length}},e.Module.Volume={name:"Volume",params:{Master:{L:0,H:1,D:.5},Attack:{L:.001,H:1,D:.01},Sustain:{L:0,H:2,D:.3},Punch:{L:0,H:3,D:1},Decay:{L:.001,H:2,D:1}},stage:s.Volume,setup:function(e,t){var n=e.SampleRate,r=t.Master,a=r*(1+t.Punch);e.envelopes=[{S:0,E:r,N:t.Attack*n|0},{S:a,E:r,N:t.Sustain*n|0},{S:r,E:0,N:t.Decay*n|0}];for(var i=0;i<e.envelopes.length;i+=1){var o=e.envelopes[i];o.G=(o.E-o.S)/o.N}},process:function(e,t){for(var n=0;e.envelopes.length>0&&n<t.length;){for(var r=e.envelopes[0],a=r.S,i=r.G,o=0|Math.min(t.length-n,r.N),u=n+o|0;n<u;n+=1)t[n]*=a,a=y(a+=i,0,10);r.S=a,r.N-=o,r.N<=0&&e.envelopes.shift()}return n}},e.DefaultModules=[e.Module.Frequency,e.Module.Vibrato,e.Module.Generator,e.Module.Filter,e.Module.Phaser,e.Module.Volume],e.DefaultModules.sort(l),e.EmptyParams=f,e._RemoveEmptyParams=p,e.Preset={Reset:function(){return f()},Coin:function(){var e=f();return e.Frequency.Start=M(880,660),e.Volume.Sustain=M(.1),e.Volume.Decay=M(.4,.1),e.Volume.Punch=M(.3,.3),M()<.5&&(e.Frequency.ChangeSpeed=M(.15,.1),e.Frequency.ChangeAmount=M(8,4)),p(e),e},Laser:function(){var e=f();return e.Generator.Func=L(["square","saw","sine"]),M()<.33?(e.Frequency.Start=M(880,440),e.Frequency.Min=M(.1),e.Frequency.Slide=M(.3,-.8)):(e.Frequency.Start=M(1200,440),e.Frequency.Min=e.Frequency.Start-M(880,440),e.Frequency.Min<110&&(e.Frequency.Min=110),e.Frequency.Slide=M(.3,-1)),M()<.5?(e.Generator.A=M(.5),e.Generator.ASlide=M(.2)):(e.Generator.A=M(.5,.4),e.Generator.ASlide=M(.7)),e.Volume.Sustain=M(.2,.1),e.Volume.Decay=M(.4),M()<.5&&(e.Volume.Punch=M(.3)),M()<.33&&(e.Phaser.Offset=M(.2),e.Phaser.Sweep=M(.2)),M()<.5&&(e.Filter.HP=M(.3)),p(e),e},Explosion:function(){var e=f();return e.Generator.Func="noise",M()<.5?(e.Frequency.Start=M(440,40),e.Frequency.Slide=M(.4,-.1)):(e.Frequency.Start=M(1600,220),e.Frequency.Slide=M(-.2,-.2)),M()<.2&&(e.Frequency.Slide=0),M()<.3&&(e.Frequency.RepeatSpeed=M(.5,.3)),e.Volume.Sustain=M(.3,.1),e.Volume.Decay=M(.5),e.Volume.Punch=M(.6,.2),M()<.5&&(e.Phaser.Offset=M(.9,-.3),e.Phaser.Sweep=M(-.3)),M()<.33&&(e.Frequency.ChangeSpeed=M(.3,.6),e.Frequency.ChangeAmount=M(24,-12)),p(e),e},Powerup:function(){var e=f();return M()<.5?e.Generator.Func="saw":e.Generator.A=M(.6),e.Frequency.Start=M(220,440),M()<.5?(e.Frequency.Slide=M(.5,.2),e.Frequency.RepeatSpeed=M(.4,.4)):(e.Frequency.Slide=M(.2,.05),M()<.5&&(e.Vibrato.Depth=M(.6,.1),e.Vibrato.Frequency=M(30,10))),e.Volume.Sustain=M(.4),e.Volume.Decay=M(.4,.1),p(e),e},Hit:function(){var e=f();return e.Generator.Func=L(["square","saw","noise"]),e.Generator.A=M(.6),e.Generator.ASlide=M(1,-.5),e.Frequency.Start=M(880,220),e.Frequency.Slide=-M(.4,.3),e.Volume.Sustain=M(.1),e.Volume.Decay=M(.2,.1),M()<.5&&(e.Filter.HP=M(.3)),p(e),e},Jump:function(){var e=f();return e.Generator.Func="square",e.Generator.A=M(.6),e.Frequency.Start=M(330,330),e.Frequency.Slide=M(.4,.2),e.Volume.Sustain=M(.3,.1),e.Volume.Decay=M(.2,.1),M()<.5&&(e.Filter.HP=M(.3)),M()<.3&&(e.Filter.LP=M(-.6,1)),p(e),e},Select:function(){var e=f();return e.Generator.Func=L(["square","saw"]),e.Generator.A=M(.6),e.Frequency.Start=M(660,220),e.Volume.Sustain=M(.1,.1),e.Volume.Decay=M(.2),e.Filter.HP=.2,p(e),e},Lucky:function(){var t=f();return P(t,function(t,n){P(e.Module[n].params,function(e,n){if(e.C){var r=A(e.C);t[n]=r[r.length*D()|0]}else t[n]=D()*(e.H-e.L)+e.L})}),t.Volume.Master=.4,t.Filter={},p(t),t}},e.G.unoise=d("sample = Math.random();"),e.G.sine=d("sample = Math.sin(phase);"),e.G.saw=d("sample = 2*(phase/TAU - ((phase/TAU + 0.5)|0));"),e.G.triangle=d("sample = Math.abs(4 * ((phase/TAU - 0.25)%1) - 2) - 1;"),e.G.square=d("var s = Math.sin(phase); sample = s > A ? 1.0 : s < A ? -1.0 : A;"),e.G.synth=d("sample = Math.sin(phase) + .5*Math.sin(phase/2) + .3*Math.sin(phase/4);");function d(e){return new Function("$","block","var TAU = Math.PI * 2;\nvar sample;\nvar phase = +$.generatorPhase,\n\tA = +$.generatorA, ASlide = +$.generatorASlide,\n\tB = +$.generatorB, BSlide = +$.generatorBSlide;\n\nfor(var i = 0; i < block.length; i++){\n\tvar phaseSpeed = block[i];\n\tphase += phaseSpeed;\n\tif(phase > TAU){ phase -= TAU };\n\tA += ASlide; B += BSlide;\n   A = A < 0 ? 0 : A > 1 ? 1 : A;\n   B = B < 0 ? 0 : B > 1 ? 1 : B;\n"+e+"\tblock[i] = sample;\n}\n\n$.generatorPhase = phase;\n$.generatorA = A;\n$.generatorB = B;\nreturn block.length;\n")}function m(t){"undefined"!=typeof Float32Array&&S(t instanceof Float32Array,"data must be an Float32Array");var a=r*n>>3,i=e.SampleRate*a,o=function(e){if("undefined"==typeof Uint8Array)for(var t=new Array(e),n=0;n<t.length;n++)t[n]=0;return new Uint8Array(e)}(44+2*t.length),u=0;function s(e){for(var t=0;t<e.length;t+=1)o[u]=e.charCodeAt(t),u++}function l(e,t){t<=0||(o[u]=255&e,u++,l(e>>8,t-1))}return s("RIFF"),l(36+2*t.length,4),s("WAVEfmt "),l(16,4),l(1,2),l(r,2),l(e.SampleRate,4),l(i,4),l(a,2),l(n,2),s("data"),l(2*t.length,4),g(o.subarray(u),t),new Audio("data:audio/wav;base64,"+function(e){for(var t="",n=0;n<e.length;n+=32768){var r=Math.min(n+32768,e.length);t+=String.fromCharCode.apply(null,e.subarray(n,r))}return btoa(t)}(o))}function g(e,t){S(e.length/2==t.length,"the target buffer must be twice as large as the iinput");for(var n=0,r=0;r<t.length;r++){var a=32767*+t[r]|0;a=a<-32768?-32768:32767<a?32767:a,a+=a<0?65536:0,e[n]=255&a,e[++n]=a>>8,n++}}function S(e,t){if(!e)throw new Error(t)}function y(e,t,n){return n=+n,(e=+e)<(t=+t)?+t:e>n?+n:+e}function v(e){return(e=+e)<0?0:e>1?1:+e}function P(e,t){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r],r));return n}function M(e,t){var n=D();return void 0!==e&&(n*=e),void 0!==t&&(n+=t),n}function L(e){return e[e.length*D()|0]}function A(e){var t=[];for(var n in e)t.push(n);return t}function F(e){if("undefined"==typeof Float32Array)for(var t=new Array(e),n=0;n<t.length;n++)t[n]=0;return new Float32Array(e)}e.G.noise=d("if(phase % TAU < 4){__noiseLast = Math.random() * 2 - 1;} sample = __noiseLast;"),e.G.string={create:function(){for(var e=65536,t=e-1,n=F(e),r=0;r<n.length;r++)n[r]=2*D()-1;var a=0;return function(r,i){for(var o=2*Math.PI,u=+r.generatorA,s=+r.generatorASlide,l=+r.generatorB,c=+r.generatorBSlide,h=n,f=0;f<i.length;f++){var p=i[f];l+=c,u=(u+=s)<0?0:u>1?1:u,l=l<0?0:l>1?1:l;var d=a-(o/p|0)+e&t,m=(1*h[d-0+e&t]+h[d-1+e&t]*u+h[d-2+e&t]*l)/(1+u+l);h[a]=m,i[f]=h[a],a=a+1&t}return r.generatorA=u,r.generatorB=l,i.length}}},e.CreateAudio=m,e.DownloadAsFile=function(e){S(e instanceof Audio,"input must be an Audio object"),document.location.href=e.src},e.Util={},e.Util.CopyFToU8=g,e._createFloatArray=F;var b=Math.random;function D(){return b()}e.setRandomFunc=function(e){b=e}}(n={}),e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0);let a,i;t.Preset=r.Preset;let o,u,s={},l=[];const c={c:t.Preset.Coin,l:t.Preset.Laser,e:t.Preset.Explosion,p:t.Preset.Powerup,h:t.Preset.Hit,j:t.Preset.Jump,s:t.Preset.Select,u:t.Preset.Lucky},h=function(e){let t=[];for(let n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t}(c);let f=.5,p=!1;function d(e){null!=a&&(a._volume.gain.value=e)}function m(){null!=a&&A(l,e=>e.stop())}function g(e,t){let n=L(t,!1),r=.5;for(let e=0;e<t/2;e++)i.f()<r&&(n[i.i(t-1)]=!0),r*=.5;return F(e,(e,r)=>n[r%t]?!e:e)}function S(e,t,n=.25){const r=new v(e);r.patternInterval=n,r.pattern="string"==typeof t?function(e,t){let n=[];for(let r=0;r<e.length;r++)n.push(t(e.charAt(r),r));return n}(t,e=>"1"===e):t,l.push(r)}t.init=function(e=0,n=120,s=60){a=r.Live({}),d(.1),u=e,i=new P,r.setRandomFunc(i.get01),t.playInterval=60/n,o=1/s*2},t.setSeed=function(e=0){u=e},t.play=function(e="0",t=2,n=null,r=null){if(null!=a)if(null==s[e]){if(i.setSeed(u+M(e)),null==n){let r=c[e[0]];void 0===r&&(r=i.sample(h)),n=L(t,r)}s[e]=new y(n),s[e].play(r)}else s[e].play(r)},t.setVolume=d,t.setQuantize=function(e){f=e},t.playBgm=function(e="0",n=.25,r=[t.Preset.Laser,t.Preset.Hit],o=8,s=null){null!=a&&(m(),i.setSeed(u+M(e)),l=[],function(e,t){for(let n=0;n<e;n++)t()}(o,()=>(function(e,t){S(i.sample(t),function(){let e=L(64,!1),t=4;for(;t<=64;)e=g(e,t),t*=2;return e}(),e)})(n,r)),A(l,e=>e.play(s)))},t.stopBgm=m,t.update=function(){if(null==a)return;const e=a._context.currentTime,t=e+o;return function(e,t){for(let n in e)t(e[n])}(s,n=>n.update(e,t)),A(l,n=>n.update(e,t)),e},t.reset=function(){m(),s={},l=[]},t.playEmpty=function(){if(null==a)return;if(p)return;const e=a._createEmptyBuffer();a._playBuffer(e,0),p=!0},t.playParam=function(e){null!=a&&a._play(e)},t.addTrack=S;class y{constructor(e){this.isPlaying=!1,this.playedTime=null,Array.isArray(e)||(e=[e]),this.buffers=F(e,e=>a._createBuffer(e)),this.gainNode=a._createGain()}play(e=null){this.isPlaying=!0,this.volume=e}stop(){this.isPlaying=!1}update(e,n){if(!this.isPlaying)return;this.isPlaying=!1;const r=t.playInterval*f,a=r>0?Math.ceil(e/r)*r:e;(null==this.playedTime||a>this.playedTime)&&(this.playLater(a),this.playedTime=a)}playLater(e){null==this.volume?A(this.buffers,t=>a._playBuffer(t,e)):(this.gainNode.gain.value=this.volume,A(this.buffers,t=>a._playBufferAndConnect(t,e,this.gainNode)))}}class v extends y{constructor(){super(...arguments),this.patternIndex=0,this.patternInterval=.25,this.scheduledTime=null}update(e,t){if(this.isPlaying){null==this.scheduledTime&&this.calcFirstScheduledTime(e);for(let t=0;t<99&&!(this.scheduledTime>=e);t++)this.calcNextScheduledTime();if(this.scheduledTime<e)this.scheduledTime=null;else for(;this.scheduledTime<=t;)this.playLater(this.scheduledTime),this.calcNextScheduledTime()}}calcFirstScheduledTime(e){this.scheduledTime=Math.ceil(e/t.playInterval)*t.playInterval-t.playInterval*this.patternInterval,this.patternIndex=0,this.calcNextScheduledTime()}calcNextScheduledTime(){const e=this.pattern.length,n=t.playInterval*this.patternInterval;for(let t=0;t<e;t++){this.scheduledTime+=n;const t=this.pattern[this.patternIndex];if(this.patternIndex++,this.patternIndex>=e&&(this.patternIndex=0),t)break}}}class P{setSeed(e=-2147483647){return-2147483647===e&&(e=Math.floor(2147483647*Math.random())),this.x=e=1812433253*(e^e>>30),this.y=e=1812433253*(e^e>>30)+1,this.z=e=1812433253*(e^e>>30)+2,this.w=e=1812433253*(e^e>>30)+3,this}f(e=null,t=null){return null==e?this.get01():null==t?this.get01()*e:this.get01()*(t-e)+e}i(e=null,t=null){return Math.floor(this.f(e,t+1))}sample(e){return e[this.i(e.length-1)]}getInt(){var e=this.x^this.x<<11;return this.x=this.y,this.y=this.z,this.z=this.w,this.w=this.w^this.w>>19^e^e>>8,this.w}get01(){return this.getInt()/2147483647}constructor(){this.setSeed(),this.get01=this.get01.bind(this),this.f=this.f.bind(this),this.i=this.i.bind(this)}}function M(e){let t=0;const n=e.length;for(let r=0;r<n;r++){t=(t<<5)-t+e.charCodeAt(r),t|=0}return t}function L(e,t){let n=[];for(let r=0;r<e;r++)n.push(t);return n}function A(e,t){for(let n=0;n<e.length;n++)t(e[n])}function F(e,t){let n=[];for(let r=0;r<e.length;r++)n.push(t(e[r],r));return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1),a=480;let i,o,u={x:0,y:0};window.onload=(()=>{r.init(9677173),(i=document.createElement("canvas")).width=i.height=a,o=i.getContext("2d"),document.body.appendChild(i),function(){const e=document.getElementById("change"),t=document.getElementById("seed"),n=document.getElementById("set");function a(){r.reset(),r.setSeed(Number(t.value)),s&&r.playBgm()}e.onclick=(()=>{t.value=Math.floor(9999999*Math.random()).toString(),a()}),n.onclick=a}(),document.onmousedown=m,document.ontouchstart=m,document.onmousemove=(e=>{g(e.clientX,e.clientY)}),document.ontouchmove=(e=>{e.preventDefault(),g(e.touches[0].clientX,e.touches[0].clientY)}),document.onmouseup=S,document.ontouchend=S,y()});let s=!1,l=0,c=0,h=240;const f=320,p=36;let d=[];function m(e){e.preventDefault(),r.playEmpty(),s||(r.playBgm(),s=!0,l=0,c=0)}function g(e,t){u.x=e-i.offsetLeft,u.y=t-i.offsetTop}function S(e){e.preventDefault()}function y(){var e,t,n;if(requestAnimationFrame(y),r.update(),o.fillStyle="white",o.fillRect(0,0,a,a),s&&(o.fillStyle="#8e8",e=u.x,t=16,n=a-16,h=Math.max(t,Math.min(e,n)),o.fillRect(h-p/2,f-p/2,p,p)),Math.random()<.1*Math.sqrt(c/1e3+1)){const e={x:480*Math.random(),y:-60},t=100*(Math.random()*Math.random()+.5),n=(Math.random()+1)*Math.sqrt(c/1e3+1)*2,r=Math.random()<.2*Math.sqrt(c/1e3+1);d.push({pos:e,size:t,speed:n,isEnemy:r})}for(let e=0;e<d.length;){const t=d[e];t.pos.y+=t.speed,o.fillStyle=t.isEnemy?"#e88":"#ee8",o.fillRect(t.pos.x-t.size/2,t.pos.y-t.size/2,t.size,t.size);const n=s&&Math.abs(t.pos.x-h)<(t.size+p)/2&&Math.abs(t.pos.y-f)<(t.size+p)/2;t.pos.y>550||n?(n&&(t.isEnemy?(r.play("u1",7),s=!1,r.stopBgm()):(r.play("c1"),l++)),d.splice(e,1)):e++}o.fillStyle="#135",o.font="24px monospace",o.fillText(String(l),20,40),c++}}]);